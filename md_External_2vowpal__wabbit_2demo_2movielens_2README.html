<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Medial Code Documentation: Low rank quadratic demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Medial Code Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Low rank quadratic demo</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This demo shows a low-rank approximation to an interaction design matrix for the <a href="http://files.grouplens.org/papers/ml-10m-README.html">movielens-1M</a> dataset.</p>
<h2><a class="anchor" id="autotoc_md87"></a>
About low-rank interactions</h2>
<p>In movielens-1M, a user has at most one rating per movie, and therefore a full interaction design between these two variables (in <code>vw</code> syntax: <code>-q um</code>) fundamentally cannot generalize. Since this situation arises in recommendation systems, low-rank approximations to interaction terms rose to prominence in the recommendation community, under the moniker "matrix factorization". However, the technique is also appropriate in non-recommendation settings, e.g., when the interaction between two high cardinality categorical variables is desired but the available data is too sparse to learn a full interaction model.</p>
<p>There is a great piece of software called <a href="http://www.libfm.org/">libfm</a> whose raison d'etre is to fit low-rank approximations to interaction designs, and the main author <a href="http://www.kaggle.com/users/25112/steffen-rendle">Steffen Rendle</a> does quite well on Kaggle. Imitation is the best form of flattery.</p>
<h2><a class="anchor" id="autotoc_md88"></a>
How it works</h2>
<p>If you have two namespaces <code>a</code> and <code>b</code>, instead of the full interaction design enabled by specifying <code>-q ab</code>, you can have a rank-k interaction design by specifying <code>--lrq abk</code>. Additionally specifying <code>--lrqdropout</code> trains with dropout which sometimes works better. When using dropout the best performing rank tends to be about twice as big as without dropout. You might find a bit of <code>--l2</code> regularization improves generalization.</p>
<h2><a class="anchor" id="autotoc_md89"></a>
Demo Instructions</h2>
<ul>
<li><code>make shootout</code>: eventually produces four results indicating test MAE (mean absolute error) on movielens-1M for<ul>
<li>linear: a model without any interactions. basically this creates a user bias and item bias fit. this is a surprisingly strong baseline in terms of MAE, but is useless for recommendation as it induces the same item ranking for all users. It achieves test MAE of 0.731.</li>
<li>lrq: the linear model augmented with rank-7 interactions between users and movies, aka, "seven latent factors". It achieves test MAE of 0.709. I determined that 7 was the best number to use through experimentation. The key additional <code>vw</code> command-line flags vs. the linear model are <code>--l2 1.25e-7 --lrq um7</code>. Performance is sensitive to the choice of <code>--l2</code> regularization strength.</li>
<li>lrqdropout: the linear model augmented with rank-14 interactions between users and movies, and trained with dropout. It achieves test MAE of 0.689. The key additional <code>vw</code> command-line flags vs. the linear model are <code>--lrq um14 --lrqdropout</code>.</li>
<li>lrqdropouthogwild: same as lrqdropout, but trained in parallel on multiple cores without locking, a la <a href="http://www.eecs.berkeley.edu/~brecht/papers/hogwildTR.pdf">Niu et. al.</a>. Test MAE is nondeterministic but typically equivalent to lrqdropout. The main purpose of this demo is to instruct on how to achieve lock-free parallel learning. (Note using the cache and a single training core can be faster than using multiple cores and parsing continuously. However in some cases data is generated dynamically in such volume that the cache is not practical, thus this technique is helpful.)</li>
</ul>
</li>
<li>the first time you invoke <code>make shootout</code> there is a lot of other output. invoking it a second time will allow you to just see the cached results.</li>
<li><code>make movie_dendrogram.pdf</code> will produce a couple of PDFs with hierarchical clustering of the movies based on the latent factors found by <code>--lrq</code>. It serves as an example on how to extract the latent factors from an <code>--invert_hash</code> file. You will need to zoom in in the large dendrogram to find the movie names.</li>
</ul>
<p>Details about how <code>vw</code> is invoked is in the <code>Makefile</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Aug 7 2025 10:36:59 for Medial Code Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
